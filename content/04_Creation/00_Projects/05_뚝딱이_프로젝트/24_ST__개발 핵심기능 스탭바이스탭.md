
## 핵심
1. 툴박스: 사각형 추가 버튼을 하나 만들기
2. 콘텍스트: addElement('rect') 함수를 구현하여 CanvasElement타입의 사각형 객체를 상태에 추가
3. Canvas: react-konva의 Reac/> 컴포넌트를 사용하여 elements 상태에 있는 사각형들을 캔버스에 렌더링
4. ProperitesPanel 사각형의 x,y,width,height,fill,stroke,strokeWidth 등을 편집 할 수 있는 입력 필드를 구현

5. **도형 선택 및 드래그:**
    
    - **Canvas:** 캔버스에 있는 사각형을 클릭했을 때 **선택된 상태**로 만듭니다. (`selectedElementId` 상태 업데이트)
    - **Canvas:** Konva의 `draggable` 속성을 사용하여 선택된 사각형을 마우스로 끌어서 이동시킬 수 있도록 합니다.
    - **Canvas:** 캔버스 빈 공간을 클릭하면 선택이 해제되도록 합니다. (`selectedElementId`를 `null`로 설정)
6. **선택된 도형 테두리 및 리사이즈/회전:**
    
    - **Canvas:** 선택된 사각형 주변에 Konva의 **`<Transformer />`** 컴포넌트를 렌더링합니다. `<Transformer />`는 도형을 리사이즈하고 회전시키는 핸들을 자동으로 제공합니다.
    - **Context/Canvas:** `<Transformer />`를 통해 변경된 도형의 `x`, `y`, `width`, `height`, `rotation` 등의 속성을 `updateElement` 함수를 통해 전역 상태에 반영합니다.
7. **원, 텍스트 도형 추가 (반복):**
    
    - 사각형과 동일한 방식으로 원 (`<Circle />`)과 텍스트 (`<Text />`) 도형을 추가합니다. 각 도형 타입에 맞는 속성(예: 원은 `radius`, 텍스트는 `text`, `fontSize` 등)을 `PropertiesPanel`에 추가하여 편집할 수 있도록 합니다.

---

### 2단계: 핵심 상호작용 및 편의 기능

MVP가 완성되면 사용자 경험을 개선하고, 보다 실제적인 드로잉 툴로 만들기 위한 기능을 추가합니다.

1. **레이어(Z-index) 관리:**
    
    - **PropertiesPanel:** 선택된 요소의 Z-index를 변경할 수 있는 "맨 앞으로", "맨 뒤로", "한 칸 앞으로", "한 칸 뒤로" 버튼을 추가합니다. (Konva `node.moveToTop()`, `node.moveToBottom()`, `node.moveUp()`, `node.moveDown()` 활용)
    - **Context:** `elements` 배열의 순서를 변경하는 `moveElementZIndex` 함수를 구현합니다.
2. **도형 복사/붙여넣기:**
    
    - 단축키(`Ctrl/Cmd + C`, `Ctrl/Cmd + V`) 또는 버튼을 통해 선택된 도형을 복사하고, 약간 오프셋된 위치에 붙여넣습니다. (새로운 ID 부여)
3. **도형 삭제:**
    
    - **PropertiesPanel:** "삭제" 버튼을 추가하거나, `Delete` 키를 눌러 선택된 도형을 삭제할 수 있도록 합니다.
    - **Context:** `removeElement` 함수를 구현하여 상태에서 요소를 제거합니다.
4. **그리드 스냅 (선택 사항):**
    
    - **Canvas:** 도형을 드래그하거나 리사이즈할 때 정해진 그리드 간격에 맞춰 스냅되도록 합니다. (Konva의 `dragBoundFunc` 또는 `transformer`의 `boundBoxFunc`를 활용하여 좌표 계산)

---

### 3단계: 고급 기능 및 저장/불러오기

툴의 활용도를 높이기 위한 고급 기능과 영구 저장 기능을 구현합니다.

1. **그룹화 기능:**
    
    - 여러 도형을 선택하여 하나의 그룹으로 묶고, 그룹 전체를 이동하거나 리사이즈할 수 있도록 합니다. (Konva의 `<Group />` 컴포넌트 활용)
    - 그룹을 해제하면 개별 도형으로 돌아갈 수 있도록 합니다.
2. **Undo/Redo (실행 취소/다시 실행):**
    
    - 사용자의 모든 액션(도형 추가, 이동, 속성 변경, 삭제 등)을 기록하고, 실행 취소/다시 실행 기능을 추가합니다. (immer와 같은 라이브러리 또는 직접 히스토리 스택 관리)
3. **프로젝트 저장/불러오기:**
    
    - **저장:** 현재 캔버스의 모든 `elements` 상태를 JSON 형태로 로컬 스토리지 또는 서버에 저장합니다.
    - **불러오기:** 저장된 JSON 데이터를 불러와 캔버스 상태를 복원합니다.
    - **내보내기:** 캔버스 내용을 이미지 파일(PNG/JPG)로 내보내는 기능을 추가합니다. (Konva `stage.toDataURL()` 활용)

---

### 4단계: UI/UX 개선 및 추가 도형/컨트롤

- **컴포넌트 라이브러리 통합:** shadcn/ui와 같은 컴포넌트 라이브러리를 적용하여 UI를 더욱 세련되게 만듭니다.
- **아이콘 추가:** Toolbox 및 PropertiesPanel에 적절한 아이콘을 사용하여 직관성을 높입니다.
- **컨텍스트 메뉴:** 캔버스에서 도형을 우클릭했을 때 나타나는 컨텍스트 메뉴를 구현합니다.
- **속성 패널 확장:** 글꼴, 정렬, 투명도, 테두리 스타일(점선 등) 등 더 다양한 속성을 추가합니다.
- **더 복잡한 도형:** 선, 화살표, 이미지, 아이콘, 사용자 정의 도형 등 추가.